# JS-Vulnerability-Detection

Collection of Meta Information from Snyk (npm): - Manually confirmed functions from Snyk

	- Go to "vulnerable dataset/snyk” and execute “node snykPages.js path/to/output/in/json”

	Crawl Snyk entries - vulnerable & Fixed functions that points to Git commits:
		- Go to "vulnerable dataset/snyk/commits” and execute “node fetchCommitFuncs.js path/to/input path/to/output/”, where path to input is the result of running snykPages.js
	Filter all the false positives:
		- Execute “node vulnerable dataset/filterVulnDS.mjs path/to/input path/to/filteredOutput” input is the output of prev step.
	Crawl Snyk entries - point to Github Vulnerable Code:
		- Go to “vulnerable dataset/snyk/vulnerable code” and execute “node fetchVulnCodeFuncs path/to/input path/to/output”, where path to input is the result of running snykPages.js
	Filter all the false positives:
		- Execute “node vulnerable dataset/filterVulnDS.mjs path/to/input path/to/filteredOutput” input is the output of prev step.
		
		- Take the output of the above and input them into the react app for manual analysis from which the vulnerability can be confirmed. Using which Semgrep patterns can be developed - for any type of vulnerability (Here Prototype pollution and ReDos)
		
		
Real world Experiment for npm modules: - Target functions

	- Go to “crawl real-world functions/npm” and execute “node getModules.js”.
	- It will create a JSON file in the path specified in the code.
	- Run Semgrep patterns on this output file


Semgrep patterns:

	- Take the result from the real world npm functions as dataset (input to the Semgrep pattern analysis.
	- Run the pattern and rules on this dataset
		- Go to go to “semgrep/”  and execute “detectRedos&protoSemgrep.mjs path/to/input path/to/output”. Input data should be in JSON and where each data entry is an object with mandatory 
	          field “{function: “code”}” and any other optional fields. 
		- It returns modified version of the input file, where objects are flagged with “protoPollution: true and/or “redos”: true” (if pattern detected).
		
	
