rules:
- id: redos1
  patterns:
    - pattern-either: 
      - pattern: |
          <...$ARG.$METHOD(/.../,...)...>
      - pattern: |
          <...$ARG.$METHOD(new RegExp('...'),...)...>
    - metavariable-regex:
          metavariable: $METHOD
          regex: (match|replace)
    - pattern-inside: |
        function ...(...,$ARG,...) {
        ...
        }
    - pattern-not-inside: |
        function ...(...,$ARG,...) {
        ...
        if(<...$ARG.length...>)
        ...
        }    

  message: direct use of match or replace
  severity: WARNING
  languages: [javascript]
  

- id: redos12
  patterns:
    - pattern-either: 
      - pattern: |
          <...$ARG1.$METHOD(/.../,...)...>
      - pattern: |
          <...$ARG1.$METHOD(new RegExp('...'),...)...>
    - metavariable-regex:
          metavariable: $METHOD
          regex: (match|replace)
    - pattern-inside: |
        function ...(...,$ARG,...) {
        ...
        $ARG1 = <... $ARG ...>
        ...
        }
    - pattern-not-inside: |
        function ...(...,$ARG,...) {
        ...
        if(<...$ARG.length...>)
        ...
        }
    - pattern-not-inside: |
        function ...(...,$ARG,...) {
        ...
        if(<...$ARG1.length...>)
        ...
        }
  message: match or replace with reassigned argument
  severity: WARNING
  languages: [javascript]


- id: redos2
  patterns:
    - pattern-either: 
      - pattern: |
          <... /.../.$METHOD($ARG) ...>
      - pattern: |
          <... new RegExp('...').$METHOD($ARG) ...>
    - metavariable-regex:
          metavariable: $METHOD
          regex: (exec|test)
    - pattern-inside: |
        function ...(...,$ARG,...) {
        ...
        }
    - pattern-not-inside: |
        function ...(...,$ARG,...) {
        ...
        if(<...$ARG.length...>)
        ...
        }
  message: direct use of test or exec
  severity: WARNING
  languages: [javascript]


- id: redos22
  patterns:
    - pattern-either: 
      - pattern: |
          <... /.../.$METHOD($ARG1) ...>
      - pattern: |
          <... new RegExp('...').$METHOD($ARG1) ...>
    - metavariable-regex:
          metavariable: $METHOD
          regex: (exec|test)
    - pattern-inside: |
        function ...(...,$ARG,...) {
        ...
        $ARG1 = <... $ARG ...>
        ...
        }
    - pattern-not-inside: |
        function ...(...,$ARG,...) {
        ...
        if(<...$ARG.length...>)
        ...
        }
    - pattern-not-inside: |
        function ...(...,$ARG,...) {
        ...
        if(<...$ARG1.length...>)
        ...
        }
  message: use of test or exec with reassigned argument
  severity: WARNING
  languages: [javascript]